#!/usr/bin/env bash
# Kanata start helper script
# Starts kanata in foreground for testing

set -e

CONFIG_FILE="{{ kanata_config_file }}"
KANATA_BIN="$(which kanata)"

echo "Starting Kanata..."
echo "Config: $CONFIG_FILE"
echo ""
echo "⚠️  This will run in foreground. Press Ctrl+C to stop."
echo "   Test CapsLock key - it should work as Ctrl"
echo ""

# Check if already running
if pgrep -f "kanata.*${CONFIG_FILE}" > /dev/null; then
    echo "❌ Kanata is already running. Stop it first with: kanata-stop"
    exit 1
fi

# Start kanata with sudo
sudo "$KANATA_BIN" --cfg "$CONFIG_FILE"
