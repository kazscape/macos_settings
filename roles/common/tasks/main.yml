---
# 1. Install Packages
- name: Install common packages
  homebrew:
    name: "{{ role_vars.packages | default([]) }}"
    state: present

# 2. Install fzf-git.sh (Manual Clone)
- name: Install fzf-git.sh
  git:
    repo: "https://github.com/junegunn/fzf-git.sh.git"
    dest: "{{ ansible_facts['user_dir'] }}/.local/share/fzf-git"
    version: main

# 3. Ensure Required Directories Exist
- name: Ensure configuration directories exist
  file:
    path: "{{ ansible_facts['user_dir'] }}/{{ item }}"
    state: directory
    mode: "0755"
  loop: "{{ role_vars.config_dirs | default([]) }}"

# 4. Create Symbolic Links
- name: Symlink configuration files
  file:
    src: "{{ role_path }}/files/{{ item.src }}"
    dest: "{{ ansible_facts['user_dir'] }}/{{ item.dest }}"
    state: link
    force: yes
  loop: "{{ role_vars.symlinks | default([]) }}"
